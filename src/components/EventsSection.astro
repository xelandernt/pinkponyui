---
import { COLORS, LAYOUT } from '../consts';

interface RenderedEvent {
	data: {
		title: string;
		when: string;
		where: string;
	};
	Content: any;
}

interface Props {
	renderedEvents: RenderedEvent[];
}

const { renderedEvents } = Astro.props;

import Event from './Event.astro';
---

<section class="events-section">
	<h2 class="section-title">Upcoming Events</h2>
	<div class="events-container">
		{renderedEvents.map((event) => {
			const { Content } = event;
			return (
				<Event 
					title={event.data.title}
					when={event.data.when}
					where={event.data.where}
				>
					<Content />
				</Event>
			);
		})}
	</div>
</section>

<style define:vars={{ 
	secondaryPink: COLORS.SECONDARY_PINK, 
	primaryPink: COLORS.PRIMARY_PINK,
	maxWidth: LAYOUT.MAX_CONTENT_WIDTH,
	mobileBreakpoint: LAYOUT.MOBILE_BREAKPOINT
}}>
	/* Events Section */
	.events-section {
		padding: 4rem 2rem;
		background: linear-gradient(180deg, rgba(26, 10, 26, 0.85) 0%, rgba(45, 27, 45, 0.85) 100%);
		position: relative;
		z-index: 2;
		overflow: hidden;
	}

	/* Extended fade overlay to blend with hero section */
	.events-section::before {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		height: 300px;
		background: linear-gradient(180deg, 
			rgba(0, 0, 0, 1) 0%, 
			rgba(0, 0, 0, 0.98) 15%,
			rgba(0, 0, 0, 0.95) 30%,
			rgba(0, 0, 0, 0.9) 50%,
			rgba(0, 0, 0, 0.8) 70%,
			transparent 100%
		);
		pointer-events: none;
		z-index: 1;
	}

	.section-title {
		font-family: "Lobster", cursive;
		font-size: clamp(2.5rem, 6vw, 5rem);
		color: var(--secondaryPink);
		text-align: center;
		margin-bottom: 3rem;
		position: relative;
		z-index: 2;
	}

	.events-container {
		max-width: var(--maxWidth);
		margin: 0 auto;
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
		gap: 2rem;
		position: relative;
		z-index: 2;
	}

	/* Hover effect: darken all cards when one is hovered */
	.events-container.has-hovered-card :global(.event-card) {
		opacity: 0.4;
		filter: brightness(0.5);
	}

	.events-container.has-hovered-card :global(.event-card.is-hovered) {
		opacity: 1;
		filter: brightness(1);
		transform: translateY(-10px) scale(1.05);
		box-shadow: 0 15px 40px rgba(255, 20, 147, 0.5);
		z-index: 10;
	}

	@media (max-width: var(--mobileBreakpoint)) {
		.events-section {
			padding: 3rem 1rem;
		}

		.events-container {
			grid-template-columns: 1fr;
		}
	}
</style>
